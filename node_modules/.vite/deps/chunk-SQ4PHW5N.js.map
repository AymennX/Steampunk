{
  "version": 3,
  "sources": ["../../media-played-ranges-mixin/dist/index.js"],
  "sourcesContent": ["function MediaPlayedRangesMixin(Base) {\n  return class MediaPlayedRanges extends Base {\n    _playedRanges = [];\n    _currentPlayedRange = null;\n    _RANGE_EPSILON = 0.5;\n    _seeking = false;\n    connectedCallback() {\n      if (super.connectedCallback) super.connectedCallback();\n      this.addEventListener(\"play\", () => this.onPlaybackStart({ time: this.currentTime }));\n      this.addEventListener(\"pause\", () => this.onPlaybackStop({ time: this.currentTime }));\n      this.addEventListener(\"ended\", () => this.onPlaybackStop({ time: this.currentTime }));\n      this.addEventListener(\"seeking\", () => this.onSeeking());\n      this.addEventListener(\"seeked\", () => this.onSeeked({ time: this.currentTime }));\n    }\n    onPlaybackStart(param = {}) {\n      this._seeking = false;\n      const { time } = param;\n      const t = typeof time === \"number\" ? time : this.currentTime;\n      if (!this._currentPlayedRange) {\n        this._currentPlayedRange = { start: t, end: t };\n      }\n    }\n    onSeeking() {\n      this._seeking = true;\n      this._commitCurrentRange();\n    }\n    onSeeked(param = {}) {\n      this._seeking = false;\n      const { time } = param;\n      const t = typeof time === \"number\" ? time : this.currentTime;\n      this._currentPlayedRange = { start: t, end: t };\n    }\n    onPlaybackStop(param = {}) {\n      const { time } = param;\n      const t = typeof time === \"number\" ? time : this.currentTime;\n      this._commitCurrentRange(t);\n    }\n    _commitCurrentRange(time) {\n      if (!this._currentPlayedRange) return;\n      if (typeof time === \"number\") {\n        this._currentPlayedRange.end = time;\n      }\n      const { start, end } = this._currentPlayedRange;\n      this._currentPlayedRange = null;\n      this.addPlayedRange(start, end);\n    }\n    addPlayedRange(start, end) {\n      if (start >= end) return;\n      const EPS = this._RANGE_EPSILON;\n      const allRanges = [...this._playedRanges, { start, end }];\n      allRanges.sort((a, b) => a.start - b.start);\n      const merged = [];\n      for (const range of allRanges) {\n        if (!merged.length) {\n          merged.push({ ...range });\n          continue;\n        }\n        const last = merged[merged.length - 1];\n        if (range.start <= last.end + EPS) {\n          last.start = Math.min(last.start, range.start);\n          last.end = Math.max(last.end, range.end);\n        } else {\n          merged.push({ ...range });\n        }\n      }\n      this._playedRanges = merged;\n    }\n    get played() {\n      const time = this.currentTime;\n      if (!this.paused && !this._currentPlayedRange && typeof time === \"number\") {\n        this._currentPlayedRange = { start: time, end: time };\n      }\n      if (this._currentPlayedRange && typeof time === \"number\") {\n        if (time > this._currentPlayedRange.end) {\n          this._currentPlayedRange.end = time;\n        }\n        this.addPlayedRange(this._currentPlayedRange.start, this._currentPlayedRange.end);\n      }\n      if (!this._playedRanges.length) {\n        return createTimeRangesObj([[0, 0]]);\n      }\n      return createTimeRangesObj(this._playedRanges.map((r) => [r.start, r.end]));\n    }\n  };\n}\nfunction createTimeRangesObj(ranges) {\n  Object.defineProperties(ranges, {\n    start: { value: (i) => ranges[i][0] },\n    end: { value: (i) => ranges[i][1] }\n  });\n  return ranges;\n}\nexport {\n  MediaPlayedRangesMixin\n};\n"],
  "mappings": "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",
  "names": []
}
